{% extends 'frontend/base.html' %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'frontend/css/admin.css' %}">
<style>
    /* CSS bổ sung để đồng bộ các nút hành động mới */
    .btn-release {
        color: #059669; /* emerald-600 */
        font-weight: 700;
        font-size: 0.875rem;
        display: flex;
        align-items: center;
        gap: 4px;
        text-decoration: none;
    }

        .btn-release:hover {
            color: #064e3b; /* emerald-900 */
            text-decoration: underline;
        }
</style>
{% endblock %}

{% block content %}
<div class="admin-wrapper">
    <aside class="admin-sidebar">
        <nav class="space-y-1">
            <a href="{% url 'frontend:admin_dashboard' %}" class="flex items-center gap-3 px-3 py-2.5 text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg font-medium transition">
                <span class="material-symbols-outlined">dashboard</span> Dashboard
            </a>

            <a href="{% url 'frontend:admin_vehicles' %}" class="flex items-center gap-3 px-3 py-2.5 bg-primary/10 text-primary rounded-lg font-medium">
                <span class="material-symbols-outlined">directions_car</span> Quản lý Xe
            </a>

            <a href="{% url 'frontend:admin_bookings' %}" class="flex items-center gap-3 px-3 py-2.5 text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg font-medium transition">
                <span class="material-symbols-outlined">calendar_month</span> Đặt chỗ
            </a>

            <a href="{% url 'frontend:admin_stats' %}" class="flex items-center gap-3 px-3 py-2.5 text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg font-medium transition">
                <span class="material-symbols-outlined">bar_chart</span> Thống kê
            </a>
        </nav>
    </aside>

    <main class="admin-content">
        <div class="header-flex">
            <h1>Danh sách Xe</h1>
            <a href="{% url 'frontend:admin_vehicle_add' %}" class="btn btn-primary btn-sm">+ Thêm xe mới</a>
        </div>

        <table class="table admin-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Tên xe</th>
                    <th>Biển số</th>
                    <th>Trạng thái</th>
                    <th>Hành động</th>
                </tr>
            </thead>
            <tbody>
                {% for vehicle in vehicles %}
                <tr>
                    <td>{{ vehicle.id }}</td>
                    <td>{{ vehicle.name }}</td>
                    <td>{{ vehicle.license_plate }}</td>
                    <td>
                        <span class="badge badge-{{ vehicle.status|lower }}">
                            {{ vehicle.get_status_display }}
                        </span>
                    </td>
                    <td>
                        <div class="action-buttons" style="display: flex; gap: 15px; align-items: center;">
                            {% if vehicle.status|upper != 'AVAILABLE' %}
                            <a href="{% url 'frontend:admin_release_vehicle' vehicle.id %}"
                               class="btn-release"
                               onclick="return confirm('Bạn có chắc chắn muốn chuyển xe này về trạng thái Có sẵn không?')">
                                <span class="material-symbols-outlined text-[18px]">lock_open</span>
                                Mở trạng thái
                            </a>
                            {% endif %}

                            <button onclick="alert('Sync tọa độ thực cho xe {{ vehicle.id }}')" class="btn-icon" title="Đồng bộ tọa độ">
                                <i class="fa-solid fa-location-dot"></i>
                            </button>

                            <a href="/admin/vehicles/vehicle/{{ vehicle.id }}/change/" class="btn-icon" title="Chỉnh sửa">
                                <i class="fa-solid fa-pen"></i>
                            </a>

                            <a href="/admin/vehicles/vehicle/{{ vehicle.id }}/delete/" class="btn-icon delete" title="Xóa">
                                <i class="fa-solid fa-trash"></i>
                            </a>
                        </div>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="5" class="text-center" style="padding: 20px; color: #94a3b8;">
                        Chưa có phương tiện nào trong hệ thống.
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </main>
</div>
{% endblock %}